/*! canal 2014-11-10 */
Object.keys||(Object.keys=function(){"use strict";var a=Object.prototype.hasOwnProperty,b=!{toString:null}.propertyIsEnumerable("toString"),c=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],d=c.length;return function(e){if("object"!=typeof e&&("function"!=typeof e||null===e))throw new TypeError("Object.keys called on non-object");var f,g,h=[];for(f in e)a.call(e,f)&&h.push(f);if(b)for(g=0;d>g;g++)a.call(e,c[g])&&h.push(c[g]);return h}}());var canal;!function(a){function b(a){return new f(a)}function c(a,b){return g.publish(a,b)}function d(a,b){return g.subscribe(a,b)}var e=function(){function a(a,b,c){this.id=a,this.validator=b,this.callback=c}return a}(),f=function(){function a(a){this.topic=a,this.subscriptionArr=[],this.nodeIdCount=0,this.identifierToValidatorDict={}}return a.prototype.makeValidatorKey=function(a){if(Object(a)!==a)throw new TypeError("Identifiers must be valid objects");var b=Object.keys(a),c=b.sort(),d=c.map(function(b){var c={};return c[b]=a[b],c});return JSON.stringify(d)},a.prototype.getOrMakeValidator=function(a){if(Object(a)!==a)throw new TypeError("Identifiers must be valid objects");var b=this.makeValidatorKey(a),c=this.identifierToValidatorDict[b];return c||(c=function(b){if(Object(b)!==a)throw new TypeError("Identifiers must be valid objects");for(var c in a)if(a.hasOwnProperty(c)){if(!b.hasOwnProperty(c))return!1;if(b[c]!==a[c])return!1}return!0},this.identifierToValidatorDict[b]=c),c},a.prototype.publish=function(){},a.prototype.subscribe=function(a,b){var c=new e(++this.nodeIdCount,this.getOrMakeValidator(a),b);return this.subscriptionArr.push(c),c.id},a}();a.Topic=f;var g=new f("root");a.topic=b,a.publish=c,a.subscribe=d}(canal||(canal={}));